// DO NOT EDIT THIS FILE DIRECTLY. IT IS GENERATED BY 'make docs'.
:author: Jake Logemann
:idprefix:
:license-type: UNLICENSED
:showtitle:
:title: cloud
:toc-title: Contents
:toc: macro

ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

:terraform-docs: link:https://terraform-docs.io[terraform-docs]
:terraform: link:https://terraform.io[terraform]
:digitalocean: link:https://digitalocean.com[digitalocean]
:nixos: link:https://nixos.org[nixos]

a {terraform} module to create a {nixos} droplet on {digitalocean}.

toc::[]

== Requirements

The following requirements are needed by this module:

- [[requirement_cloudinit]] <<requirement_cloudinit,cloudinit>> (~> 2.2)

- [[requirement_digitalocean]] <<requirement_digitalocean,digitalocean>> (~> 2.0)

== Providers

The following providers are used by this module:

- [[provider_cloudinit]] <<provider_cloudinit,cloudinit>> (2.2.0)

- [[provider_digitalocean]] <<provider_digitalocean,digitalocean>> (2.25.2)

== Resources

The following resources are used by this module:

- https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/droplet[digitalocean_droplet.main] (resource)
- https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/floating_ip[digitalocean_floating_ip.main] (resource)
- https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/volume[digitalocean_volume.main] (resource)
- https://registry.terraform.io/providers/hashicorp/cloudinit/latest/docs/data-sources/config[cloudinit_config.user_data] (data source)
- https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/data-sources/ssh_keys[digitalocean_ssh_keys.all] (data source)
- https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/data-sources/vpc[digitalocean_vpc.default] (data source)

== Optional Inputs

The following input variables are optional (have default values):

=== [[input_external_volumes]] <<input_external_volumes,external_volumes>>

Description: provision a Block Volume for each host?

Type: `bool`

Default: `false`

=== [[input_floating_ip]] <<input_floating_ip,floating_ip>>

Description: reserve a Floating IP for each host?

Type: `bool`

Default: `false`

=== [[input_host_count]] <<input_host_count,host_count>>

Description: how many hosts should be managed?

Type: `number`

Default: `1`

=== [[input_infect_script]] <<input_infect_script,infect_script>>

Description: where is the nixos-infect script?

Type: `string`

Default: `"https://raw.githubusercontent.com/elitak/nixos-infect/master/nixos-infect"`

=== [[input_nix_channel]] <<input_nix_channel,nix_channel>>

Description: which nix channel should be used for managed hosts?

Type: `string`

Default: `"nixos-unstable"`

=== [[input_node_image]] <<input_node_image,node_image>>

Description: which digitalocean base image should be used?

Type: `string`

Default: `"debian-11-x64"`

=== [[input_node_name]] <<input_node_name,node_name>>

Description: what name should be given to instance(s)?

Type: `string`

Default: `"nixlet"`

=== [[input_node_size]] <<input_node_size,node_size>>

Description: which digitalocean droplet size should be used?

Type: `string`

Default: `"s-1vcpu-1gb-intel"`

=== [[input_region]] <<input_region,region>>

Description: which digitalocean region should be used?

Type: `string`

Default: `"nyc3"`

== Outputs

The following outputs are exported:

=== [[output_ssh_commands]] <<output_ssh_commands,ssh_commands>>

Description: ssh commands to connect to each instance.

== Development

1. install {terraform}

2. run `terraform init` to fetch required providers.

3. export `DIGITALOCEAN_TOKEN=...` to set your credentials.

4. plan a deployment with `terraform plan`.

5. apply the plan with `terraform apply`.

== Appendix

* This documentation is automatically generated by {terraform-docs}. Update by running `make docs`.

// vim: ft=asciidoc